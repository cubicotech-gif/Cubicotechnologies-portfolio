name: ðŸš€ Deploy to Web Hosting via FTP

# When to run this workflow
on:
  push:
    branches:
      - main                # Deploys when you push to main branch
      - claude/**           # Also deploys from claude branches
  workflow_dispatch:        # Allows manual deployment from GitHub Actions tab

jobs:
  deploy:
    name: ðŸ“¦ Deploy Website to Hosting
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: ðŸ” Show what will be deployed
        run: |
          echo "ðŸ“¦ Files to be deployed:"
          echo "================================"
          ls -lah *.html 2>/dev/null || echo "No HTML files"
          echo ""
          echo "CSS Files:"
          ls -lah css/ 2>/dev/null || echo "No CSS folder"
          echo ""
          echo "JS Files:"
          ls -lah js/ 2>/dev/null || echo "No JS folder"
          echo "================================"

      - name: ðŸš€ Deploy via SFTP to Web Hosting
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          # SFTP Server Configuration (stored securely in GitHub Secrets)
          # Works with: HostGator, Namecheap, Bluehost, GoDaddy, and most cPanel hosting
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}

          # Deployment Configuration
          # âš™ï¸ DEPLOYMENT DIRECTORY OPTIONS:
          # - Replace WordPress: /public_html/
          # - Subdomain (portfolio.domain.com): /public_html/portfolio/
          # - Subfolder (domain.com/portfolio): /public_html/portfolio/
          server-dir: /public_html/              # âš ï¸ Change this based on your choice!

          protocol: ftps-legacy                  # Try ftps-legacy for better compatibility
          port: 21                               # FTP port (usually 21)

          # What to deploy
          local-dir: ./                          # Deploy from root of repository

          # What NOT to deploy (exclude these)
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/README.md
            **/NAMECHEAP-DEPLOYMENT-GUIDE.md
            **/HOSTGATOR-DEPLOYMENT.md
            **/HOSTGATOR-QUICKSTART.md
            **/QUICK-DEPLOY.md
            **/QUICK-START.md
            **/AUTO-DEPLOY-SETUP.md
            **/create-deployment-package.sh
            **/cubico-website-package.zip
            **/.github/**
            **/.vscode/**
            **/.DS_Store
            **/Thumbs.db
            **/*.md

          # Deployment options
          dangerous-clean-slate: false           # Don't delete all files first (safer)
          dry-run: false                         # Set to true to test without deploying

      - name: âœ… Deployment Complete
        run: |
          echo "================================"
          echo "âœ… Deployment Successful!"
          echo "================================"
          echo "ðŸŒ Your website has been updated at:"
          echo "   https://yourdomain.com"
          echo ""
          echo "ðŸ“‹ What was deployed:"
          echo "   - All HTML pages"
          echo "   - CSS styling"
          echo "   - JavaScript files"
          echo ""
          echo "ðŸŽ‰ Your changes are now LIVE!"
          echo "================================"

      - name: ðŸ“Š Deployment Summary
        if: always()
        run: |
          echo "### ðŸš€ Deployment Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… **Status**: Deployment completed successfully" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸ“¦ **Deployed Files**:" >> $GITHUB_STEP_SUMMARY
          echo "- HTML pages (index, services, process, contact)" >> $GITHUB_STEP_SUMMARY
          echo "- CSS styling (css/style.css)" >> $GITHUB_STEP_SUMMARY
          echo "- JavaScript files (js/main.js, js/supabase-config.js)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ðŸŒ **Website**: Your changes are now live!" >> $GITHUB_STEP_SUMMARY
